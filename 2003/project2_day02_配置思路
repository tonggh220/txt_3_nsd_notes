一、升级网站运行平台到lnmp （2台网站服务器都要配置）
	1.1 清除网站的当前配置
	1.2 部署lnmp环境

二、部署缓存服务
	2.1 准备6台Redis服务器（运行redis服务并启用了集群功能）
	2.2 部署管理主机 192.168.4.77
		2.2.1 配置集群管理脚本运行环境
		2.2.2 创建管理脚本

		2.2.3 创建集群
]# redis-trib.rb create --replicas 1 192.168.4.51:6379 192.168.4.52:6379 192.168.4.53:6379 192.168.4.54:6379 192.168.4.56:6379 192.168.4.57:6379

		2.2.4 查看集群信息
]# redis-trib.rb info  192.168.4.51:6379 

		2.2.5  配置网站服务器，可以连接redis集群存数据、取数据 （2台网站服务器都要配置）
			2.2.5.1  安装提供连接集群模块的软件
			2.2.5.2  修改PHP程序的配置文件加载模块
			2.2.5.3  重启php-fpm服务

                  测试配置
			2.2.5.4  在30主机的共享目录下并PHP脚本
					1 连接redis集群存数据的脚本
[root@nfs30 sitedir]# cat /sitedir/set.php 
<?php
$redis_list = ['192.168.4.51:6379','192.168.4.52:6379','192.168.4.53:6379','192.168.4.54:6379','192.168.4.56:6379','192.168.4.57:6379'];
$client = new RedisCluster(NUll,$redis_list);
$client->set("i","tarenaA ");
$client->set("j","tarenaB ");
$client->set("k","tarenaC ");
echo  "data save ok ";
?>
[root@nfs30 sitedir]# 

					2 连接redis集群存数据的脚本
[root@nfs30 sitedir]# cat /sitedir/get.php 
<?php
$redis_list = ['192.168.4.51:6379','192.168.4.52:6379','192.168.4.53:6379','192.168.4.54:6379','192.168.4.56:6379','192.168.4.57:6379'];

$client = new RedisCluster(NUll,$redis_list);

echo $client->get("i");
echo $client->get("j");
echo $client->get("k");
?>
[root@nfs30 sitedir]# 


			2.2.5.5   访问网站服务器存数据php脚本
[root@MaxScale77 ~]# curl  http://192.168.4.33/set.php
data save ok

			1.2.5.6   在redis集群主机本机查看数据
[root@host51 ~]# redis-cli -c -h 192.168.4.51 -p 6379
192.168.4.51:6379> keys *
1) "j"
192.168.4.51:6379> exit
[root@host51 ~]# 
[root@host51 ~]# redis-cli -c -h 192.168.4.52 -p 6379
192.168.4.52:6379> keys *
1) "k"
192.168.4.52:6379> exit
[root@host51 ~]# 
[root@host51 ~]# redis-cli -c -h 192.168.4.53 -p 6379
192.168.4.53:6379> keys *
1) "i"
192.168.4.53:6379>
			
			2.2.5.7   访问网站服务器取数据的php脚本
[root@MaxScale77 ~]# curl  http://192.168.4.33/get.php
tarenaA tarenaB tarenaC 



三、数据迁移
	3.1 把66主机配置为11 的slave 服务器
		3.1.1 安装MySQL服务软件 启动服务 并做初始化配置  15：44

		3.1.2 把66配置为11的slave 服务器  时间到 16:35

			 修改server_id  并重启数据库服务

			 确保与当前的master服务器11  数据一致
					#在11主机做完全备份
					#在66主机使用完全备份恢复数据

			 指定主服务器信息

			 查看状态

			 网站服务器访问77主机存储的数据， 在66 主机也有

		3.1.3 创建PXC集群
			  1 在66 主机安装PXC集群软件
[root@pxc66 ~]# systemctl stop  mysqld
[root@pxc66 ~]# rpm -e --nodeps  mysql-community-common mysql-community-devel mysql-community-test mysql-community-minimal-debuginfo mysql-community-libs mysql-community-server mysql-community-embedded mysql-community-embedded-devel mysql-community-embedded-compat mysql-community-client mysql-community-libs-compat  

   35  rpm -q libev
   36  yum -y install percona-xtrabackup-24-2.4.13-1.el7.x86_64.rpm 
   37  yum -y install qpress-1.1-14.11.x86_64.rpm 
   39  tar -xvf Percona-XtraDB-Cluster-5.7.25-31.35-r463-el7-x86_64-bundle.tar 
   42  yum -y install Percona-XtraDB-Cluster-*.rpm

			2 在66 主机 修改配置文件

			3 在66 主机 启动mysql服务 
			
			4 在66 主机 管理登录查看信息
[root@pxc66 pxc]# mysql -uroot -p123qqq...A -e 'show status like "%wsrep%"'
[root@pxc66 pxc]# mysql -uroot -p123qqq...A -e 'show slave status \G'

			
			5 配置主机10

			6 配置主机88
			
			7 公共配置


四、配置集群
	4.1 配置 pxc 主机的  LB 集群
	4.2 配置调度器的HA 集群


            